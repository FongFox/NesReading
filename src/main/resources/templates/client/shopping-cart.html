<!DOCTYPE html>
<html xmlns:th="http://www.w3.org/1999/xhtml">
<head>
    <title>Shopping Cart - NesReading</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Link CSS, Bootstrap và các thư viện khác -->
    <link rel="stylesheet" th:href="@{https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css}">
    <link rel="stylesheet" th:href="@{/styles/client/style.css}">
</head>

<body>
<header th:replace="~{layouts/client-layout :: header}"></header>

<section class="hero-section position-relative padding-large"
         style="background-image: url('images/default/banner-image-bg-1.jpg'); background-size: cover; background-repeat: no-repeat; background-position: center; height: 400px;">
    <div class="hero-content">
        <div class="container">
            <div class="row">
                <div class="text-center">
                    <h1>Shopping Cart</h1>
                    <div class="breadcrumbs">
                        <span class="item"><a th:href="@{/}">Home > </a></span>
                        <span class="item text-decoration-underline">Shopping Cart</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="cart padding-large">
    <div class="container">
        <div class="row">
            <div class="cart-table">
                <div class="cart-header border-bottom border-top">
                    <div class="row text-capitalize">
                        <h4 class="col-lg-4 py-3">Product</h4>
                        <h4 class="col-lg-3 py-3">Quantity</h4>
                        <h4 class="col-lg-3 py-3">Subtotal</h4>
                        <h4 class="col-lg-2 py-3">Action</h4>
                    </div>
                </div>

                <!-- Loop qua các CartItem -->
                <div th:if="${cart.cartItems.size() > 0}">
                    <div th:each="item : ${cart.cartItems}" class="cart-item border-bottom padding-small">
                        <div class="row align-items-center">
                            <!-- Product Info -->
                            <div class="col-lg-4 col-md-3">
                                <div class="d-flex align-items-center gap-2">
                                    <img th:src="${item.book.imageUrl}" alt="cart-img" class="img-fluid border rounded-3" style="width: 80px; height: auto;">
                                    <div>
                                        <h5><a th:href="@{/shop/{id}(id=${item.book.id})}" th:text="${item.book.title}"></a></h5>
                                        <div class="text-primary fw-light" th:text="${#numbers.formatDecimal(item.price, 0, 'COMMA', 0, 'POINT') + ' VND'}"></div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Quantity -->
                            <div class="col-lg-3 col-md-3">
                                <span class="text-primary fs-5" th:text="${item.quantity}"></span>
                            </div>
                            
                            <!-- Subtotal -->
                            <div class="col-lg-3 col-md-3">
                                <span class="text-primary fs-5" th:text="${#numbers.formatDecimal(item.getTotalPrice(), 0, 'COMMA', 0, 'POINT') + ' VND'}"></span>
                            </div>

                            <!-- Action (Remove) -->
                            <div class="col-lg-2 col-md-2">
                                <a th:href="@{/cart/remove-item(itemId=${item.id})}" class="btn btn-danger">Remove</a>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Thông báo nếu giỏ hàng trống -->
                <div th:if="${cart.cartItems.size() == 0}" class="text-center my-4">
                    <h4>Your cart is empty.</h4>
                </div>

                <!-- Cart Totals -->
                <div class="cart-totals padding-medium">
                    <h3>Cart Totals</h3>
                    <table class="table">
                        <tr class="border-top border-bottom">
                            <th>Subtotal</th>
                            <td class="text-primary ps-5 fw-light" th:text="${#numbers.formatDecimal(cart.totalPrice, 0, 'COMMA', 0, 'POINT') + ' VND'}">0.00</td>
                        </tr>
                        <tr class="border-bottom">
                            <th>Total</th>
                            <td class="text-primary ps-5 fw-light" th:text="${#numbers.formatDecimal(cart.totalPrice, 0, 'COMMA', 0, 'POINT') + ' VND'}">0.00</td>
                        </tr>
                    </table>
                    <div class="button-wrap d-flex gap-3">
                        <a th:href="@{/shop(page=${1})}" class="btn btn-secondary">Continue Shopping</a>
                        <form th:action="@{/order-now-bulk}" method="post" class="d-inline">
                            <button type="submit" class="btn">Proceed To Checkout</button>
                        </form>

                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<footer th:replace="~{layouts/client-layout :: footer}"></footer>

<!-- Scripts -->
<script th:src="@{https://use.fontawesome.com/releases/v6.3.0/js/all.js}" crossorigin="anonymous"></script>
<script th:src="@{https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js}"></script>
</body>
</html>
